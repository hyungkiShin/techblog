분명.. 시작은 프론트였는데요



안녕하세요 ? 온라인서비스개발랩 프로퍼티 파트 에서  결제 시스템을 개발하고 있는 신형기 입니다. 



저는 새로이 꾸려지게 된 “결제 고도화 TF 팀” 에서,  프론트엔드 개발자가 백엔드도 함께 봐야했던 상황에서의 극복기 를 주제로 이번 포스팅에 참여하게 되었습니다 ! 



먼저, 프론트 포지션에서 백앤드를 할수밖에 없었던 이유를 말씀 드리려면, 현재 기존 결제시스템이 어떻게 이루어져 있는지 설명을 드려야 할 것 같습니다.



TF 팀에서 하는 일은 기존 결제 시스템을 고도화 하는 작업으로,  프론트 작업자 기준에서 부터 말씀을 드리자면,

백엔드에 있어야 할 결제처리 로직이 프론트에 집중적으로 몰려있고, 너무  많은 메서드 체이닝으로 비즈니스 로직을 풀어내다 보니 장애대응시 원인을 파악하여 이를 대응하는점에 있어서 어려움을 겪고 결제 수단을 추가하는데 있어서도 비용이 많이 들자 이를  이슈업 하게 되었습니다.



간단하게 비유를 들기 위해 비슷한 상황을 재현해 보았습니다, 문제의 코드는 아래와 같은 형태로 개발되어 있었습니다

실제 코드를 보여드릴수 없다는점은 양해부탁드립니다   .

- 샘플 코드 예시

위 코드를 보니, A 함수 가 종료 되기전에, 검증로직으로 보이는 부분과, 비동기 호출 부분도 있습니다.

그리고 데이터를 가공한 다음 B 함수를 호출하고 C 와 D ... 음..?

간단 요약하여, 각 구간마다 특정 필드를 분기하여 (네이버, 카카오, 페이코 등등.) 최종적으로 전달해야할 파라미터에서 간혹 누수가 생기기도 하고 리펙토링 조차 엄두가 나지 않게 생겼습니다.

( 뭐지 이게 ㅜ 같은 짤 )

이런식으로 함수안에서 또다른 함수를 호출하면서 넘기고 넘기는 메서드 체이닝이 난무하다 보니

결제 수단을 추가하는건 둘째 치고, 유지보수 및 대응 자체가 쉽지 않았습니다.
때문에, 처음엔 열심히 분석후 백엔드로 로직을 슝 ~ 하고 옮기면 되는것 아닌가 하고 생각했습니다만 ..!



저는 처음 들어보는데 혹시 ICE Framework 라는 친구를 아시나요 ..?

백엔드에서는 ICE Framework 를 커스텀해서 사용하고 있는데요,  ( 현재는 걷어내는 중입니다 ! )

커스텀된 ICE Framework 에 대해서 아주 아주 간단하게 말씀드리면, Spring Framework 를 한번 더 프레임워크로 포장 한 형태 입니다.

한번더 감싸 ..?

ICE Framework 자체도 국내에 레퍼런스가 많이 없기때문에 더욱 유지보수가 힘들었고,
심지어 커스텀된 ICE Framework 는 더더욱 새로운 기능 및 유지보수가 어려웠습니다 (구글에 글이 별로 없어서; )

커스텀된 ICE Framework 의 자세한 이야기는 나중에 좋은 블로그 글로 올라오게 될 것같아, 더이상 언급하지 않겠습니다 !



때문에 (구글에 글이 별로 없어서) 위에서 언급드렸던 “ 백엔드로 슝~ 하고 옮기는게” 쉽지 않는점을 떠나 조직 구성원 모두의 골칫거리 였습니다, 앞으로 새로운 개발건과, 유지보수를 어떻게 대응할지 고민하게 되었고, 그결과 현재는 온라인 서비스개발랩의 모든 서비스가 소위 말하는 국민스팩 격인 Spring 과 JPA 로 전환하는 중입니다.



이 과정을 “함께” 하기 위해 저희 TF 팀 도 탄생하게 되었습니다. 짝짝짝 🎉  🎉  

이제. 다시 잘 만들려고 하니 “학습과 정보” 가 필요했습니다 

데이터를 어떻게 모델링 해서 적재할건지에 대한 개선 논의 필요. 

개선 후 데이터를 어떻게 관리 및 추적이 용이하고, 필요 시 어떻게 꺼내올건지에 대한 전략 필요. 

데이터 일관성을 위해 MSA 환경의 트랜잭션에 대한 수준급 지식 필요.

이 과정에서 쿠폰 + 마일리지 + 상품권 + PG  에 대한 이해도는 덤    

문서화 되어있지 않고 프론트에 몰려있는 비즈니스 로직 분석 필요

따라오는 기존 백엔드 비즈니스 로직 분석 필요



그런데 막상 프로젝트 투입을 하니 TF 팀 모두 백엔드가 가능은 하지만 주력 언어가 프론트엔드인 뭔가 좀 거시기한 상황 이였습니다. ( 축구하러 가서 나만 골키퍼줄 알았더니 골키퍼가 4명인 ?  )

무언가 약간 소위 말하는 풀스택 개발을 하게되는구나 싶었지만, 현실은 녹록치 않다는것을 깨닳았습니다.

어머. 내뒷ㅌ…;

프로퍼티 파트장님께선 효율적으로 포지션을 나누어 개발하는게 어떻냐 제시하셨는데, 의사결정이 쉽게 나지 않을것 같아서가위바위보 대신 .. 사다리게임을 하기로 했습니다.

출처 - 네이버 사다리 게임

어

어. 근데 아니 근데 잠깐만 나  

진짜로 ? ( 하필 골라도 )

- PS. 지금은 TF 팀 에 백엔드 시니어분이 새로 오셔서 가이드를 주신덕에 모두가 백엔드를 겸하고있습니다 ㅎㅎ 🙌


프로젝트를 처음부터 셋팅해야 했기에 어디까지 구축해놔야 하는지를 공통 파트장님께 여쭈어 가면서 진행하던중 

어랏…? 백엔드와 프론트의 비슷한 점들이 많았습니다.


백엔드와 프론트엔드의 환경구성은 유사한 점이 많았습니다.

백엔드는 build.gradle 을 이용하여 필요한 라이브러리를 참조하였는데, 그것은 프론트엔드의 package.json 과 매우 유사했습니다.

백엔드의 build.gradle 을 먼저 보겠습니다.

예시

build.gradle 에서는 사용할 라이브러리 를 dependencies 에 기재해주니, intelliJ 에서는 build.gradle 내용이 변할시 우상단의 코끼리가 한번 노출되는데 이때 살포시 눌러주면 필요한 의존성 라이브러리 들을 다운받아 줍니다.



그럼 이제 프론트엔드 의 package.json 을 같이 보시죠 ..!

package.json 도 사용할 라이브러리를 dependencies 에 기재해주고, npm install 로 의존성 라이브러리 들을 다운받아줍니다.

아 물론 우리는 라이브러리 별로 터미널에서 ( $ npm i [라이브러리]) 입력하는게 더 친숙 하긴 하지만 ..  

예시

build.gradle 과 package.json 둘 다 의존성 라이브러리를 관리측면에선 상당히 흡사했습니다  



또 dev, stg, prod 환경을 잡아주는 방법이 비슷했습니다.

프로젝트를 하다보면 개발계, 검증계, 운영계 각 환경별로 나누어서 개발, 테스트 하는경우가 많은데

백엔드에선 yml 파일로 각 환경에 맞는 환경을 띄워줄수 있는것도 프론트의 env 와 비슷했습니다.


Back-end





Front-end







뭔가 프론트랑 환경잡는것과 비슷한 개념들 (기초 문법 등등 ) 을 짝지어서 보고 나서 이제 뭔가 할수있을것 같다는 착각이 일어났습니다.

어려운게 뭐야 ? 라고 생각이 들때 여기서 부터 진짜 시작 이였습니다 .

출처 - 데일리 미팅 자료







바로 고도화를 하기전에 파일럿 프로젝트를 진행하면서 팀원 들과 요구사항을 간단히 정리 하였습니다.



각자 필요한 기능을 나누어 개발하기위해 막상 필요한 API 를 뽑아내려하니, 제가 안다고 생각했던 자바는 ..? 

( 적절한 짤 필요 ) 

이때 공통 파트에서 도와주시지 않았더라면 ㅎㅎ.. 너무 친절히 알려주시고 아낌없이 공유해 주신덕에 파일럿 프로젝트에 필요한 API 를 무리없이 뽑아낼 수 있었습니다.


TF 팀원 분과 매일 공유하며 동료리뷰를 한 부분도 정말 톡톡히 덕봤습니다.



더이상 머릿속에 희미하게 살아있는지 생사를 알수 없는 지식들을 재적립하기 위해 조언을 구했고. 인강과, 책을 지원받아 다시 기초 공사를 병행 하는데 도움을 받을 수 있었습니다 ! ( 너무 감사드려요 )

이렇게 놓고 보니깐 얼마나 기초가 중요한지 새삼 느꼇습니다.



무사히 파일럿 프로젝트를 마치고 이제 “진짜” 를 만들기 위해 피처산정과, 인터페이스를 설계하며 진행중에 ..

번 아웃이 온듯합니다 ㅠ..

 

이를 극복하게 해준건 아이러니 하게도 운영중 “ 장애대응건 “ 이였습니다.

이때까지는 정말 프론트 입장 이였을땐 몰랐는데 로그를 정말정말 잘 심어 놔야 겠다는 생각이 들었습니다. 
서비스는 운영중에는 장애가 날 수 있습니다. 이때야 말로, 로그가 빛을 발하는것 같습니다.


추적이 용이한 로그를 보기좋게 UI 로 만들어 놓는것도 좋겠지만 log 자체가 있는것에 감사함이 절로나왔습니다.

뭔가 하나씩 점점 시야가 넓어지는 듯한 느낌은 아직 꼬맹이여서 그런것일까요  

이제 어였한 백엔드 대용품 ? 이 되었으니  AS-IS 결제 LOG 를 보다 더 자세한 예외처리에 대한 부분과, 트랜잭션 구간별로 잘 남겨야 싶다는 생각이 들었습니다. 

아좌좌 화이팅!!! 

 

아직 갈길이 멀긴 하지만 지금까지 과정에서 깨달은 것들

내가 알고 있었다는 기초 개발 지식 제발 의심 또 의심

얕게 알았던 지식은 그냥 모르는 것 이더라. 키워드를 기억하고 꾸준히 지속하자 명확한 선을 그릴수 있을때 까지.

서비스 관점에선 프론트 관점 만 알아선 서비스의 큰 그림을 알기 힘들다

Back-end 가 하는 역할을 알면 프론트 에서도 전략을 짤 수 있다.

 학습을 계획한다고 그 계획에 대한 목표에 도달한다는 보장 이 없음 

결국 지속 만이 답이다

못하는것을 “인정” 할때 비로소 성장 할 가능성이 높더라

아는것과 모르는것을 명확하게 나누는것을 연습하자

코드리뷰 를 생활화 하자

속도가 Best 이긴 하지만 코드에 지속적으로 관심을 가지고 upgrade 하자 

서비스 운영중 로그는 정말 중요하다

공통파트 분들 + TF 팀원 분들 (통칭 HANA 인 분들) 께서  잘 알려주신덕에 현재는!  잘 적응중입니다 ❤️ !! 

부족한 글 읽어주셔서 감사드리며 다음 포스팅때 뵐 수 있게 된다면 그때는 지금보다 더 많은것들을 공유하고 싶습니다.

감사합니다.
